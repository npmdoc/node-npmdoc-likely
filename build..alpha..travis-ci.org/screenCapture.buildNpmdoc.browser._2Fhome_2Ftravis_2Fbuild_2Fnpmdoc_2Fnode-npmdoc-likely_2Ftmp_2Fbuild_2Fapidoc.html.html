<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/sbyrnes/likely.js">likely (v0.2.0)</a>
</h1>
<h4>Recommendation engine for Node.js applications.</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.likely">module likely</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.Bias">
            function <span class="apidocSignatureSpan">likely.</span>Bias
            <span class="apidocSignatureSpan">(average, rowBiases, colBiases)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.Model">
            function <span class="apidocSignatureSpan">likely.</span>Model
            <span class="apidocSignatureSpan">(inputMatrix, rowLabels, colLabels)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.buildModel">
            function <span class="apidocSignatureSpan">likely.</span>buildModel
            <span class="apidocSignatureSpan">(inputArray, rowLabels, colLabels)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.buildModelWithBias">
            function <span class="apidocSignatureSpan">likely.</span>buildModelWithBias
            <span class="apidocSignatureSpan">(inputArray, bias, rowLabels, colLabels)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.calculateBias">
            function <span class="apidocSignatureSpan">likely.</span>calculateBias
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.calculateColumnAverage">
            function <span class="apidocSignatureSpan">likely.</span>calculateColumnAverage
            <span class="apidocSignatureSpan">(inputMatrix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.calculateError">
            function <span class="apidocSignatureSpan">likely.</span>calculateError
            <span class="apidocSignatureSpan">(estimated, input, bias)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.calculateMatrixAverage">
            function <span class="apidocSignatureSpan">likely.</span>calculateMatrixAverage
            <span class="apidocSignatureSpan">(inputMatrix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.calculateRowAverage">
            function <span class="apidocSignatureSpan">likely.</span>calculateRowAverage
            <span class="apidocSignatureSpan">(inputMatrix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.calculateTotalError">
            function <span class="apidocSignatureSpan">likely.</span>calculateTotalError
            <span class="apidocSignatureSpan">(errorMatrix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.generateRandomMatrix">
            function <span class="apidocSignatureSpan">likely.</span>generateRandomMatrix
            <span class="apidocSignatureSpan">(rows, columns)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">likely.</span>ALPHA</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">likely.</span>BETA</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">likely.</span>DESCENT_STEPS</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">likely.</span>K</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">likely.</span>MAX_ERROR</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">likely.</span>Model.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.likely.Model">module likely.Model</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.Model.Model">
            function <span class="apidocSignatureSpan">likely.</span>Model
            <span class="apidocSignatureSpan">(inputMatrix, rowLabels, colLabels)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.likely.Model.prototype">module likely.Model.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.Model.prototype.rankAllItems">
            function <span class="apidocSignatureSpan">likely.Model.prototype.</span>rankAllItems
            <span class="apidocSignatureSpan">(row)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.likely.Model.prototype.recommendations">
            function <span class="apidocSignatureSpan">likely.Model.prototype.</span>recommendations
            <span class="apidocSignatureSpan">(row)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.likely" id="apidoc.module.likely">module likely</a></h1>


    <h2>
        <a href="#apidoc.element.likely.Bias" id="apidoc.element.likely.Bias">
        function <span class="apidocSignatureSpan">likely.</span>Bias
        <span class="apidocSignatureSpan">(average, rowBiases, colBiases)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Bias(average, rowBiases, colBiases) {
	this.average = average;		// Overall value average
	this.rowBiases = rowBiases; // Bias for each row
	this.colBiases = colBiases;	// Bias for each column
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.Model" id="apidoc.element.likely.Model">
        function <span class="apidocSignatureSpan">likely.</span>Model
        <span class="apidocSignatureSpan">(inputMatrix, rowLabels, colLabels)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Model(inputMatrix, rowLabels, colLabels) {
	this.rowLabels = rowLabels;	// labels for the rows
	this.colLabels = colLabels; // labels for the columns
	this.input = inputMatrix;	// input data
	
	// estimated data, initialized to all zeros
	this.estimated = sylvester.Matrix.Zeros(this.input.rows(),this.input.cols());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.buildModel" id="apidoc.element.likely.buildModel">
        function <span class="apidocSignatureSpan">likely.</span>buildModel
        <span class="apidocSignatureSpan">(inputArray, rowLabels, colLabels)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function buildModel(inputArray, rowLabels, colLabels)
{
	return buildModelWithBias(inputArray, undefined, rowLabels, colLabels);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var colLabels = ['Red', 'Blue', 'Green', 'Purple'];

Using these values, John rates Red 1 while Joe rates Red 7. Sue has no rating for Blue.

#### STEP 2. Train the model
Using the inputMatrix you build a model, which estimates the ratings for all entities for all users.
&lt;!-- language: lang-js --&gt;
    var Model = Recommender.<span class="apidocCodeKeywordSpan">buildModel</span>(inputMatrix, rowLabels, colLabels);

or, if you don't have or care about labels
&lt;!-- language: lang-js --&gt;
    var Model = Recommender.buildModel(inputMatrix);

The Model object now contains a matrix of the same size as inputMatrix but with estimates ratings for
all items for all entities.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.buildModelWithBias" id="apidoc.element.likely.buildModelWithBias">
        function <span class="apidocSignatureSpan">likely.</span>buildModelWithBias
        <span class="apidocSignatureSpan">(inputArray, bias, rowLabels, colLabels)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function buildModelWithBias(inputArray, bias, rowLabels, colLabels)
{
	var model = new Model($M(inputArray), rowLabels, colLabels);
	model.estimated = train(sylvester.Matrix.create(inputArray), bias);
	
	return model
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
In a lot of input data there is inherent bias. For example, a given user might tend to rate a great movie as 10 stars which another
 user never gives above 8 stars.
These inherent biases can skew the estimations by providing false signals to the model. To handle these, you can adjust for biases
 by including them in your model
building.
&lt;!-- language: lang-js --&gt;	
	var bias = Recommender.calculateBias(input);
	
    // Build the model using the training set and considering the bias
    var model = Recommender.<span class="apidocCodeKeywordSpan">buildModelWithBias</span>(trainingSet, bias);
	
The resulting model should be very similar to the one obtained without providing bias, but more accurate.

FAQ
---------
#### I used Likely.js to generate recommendations based on my data. How do I know if it's working?
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.calculateBias" id="apidoc.element.likely.calculateBias">
        function <span class="apidocSignatureSpan">likely.</span>calculateBias
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function calculateBias(input)
{
	var inputMatrix = $M(input);
	var average = calculateMatrixAverage(inputMatrix);
	var rowAverages = calculateRowAverage(inputMatrix);
	var colAverages = calculateColumnAverage(inputMatrix);
	
	var rowBiases = new Array();
	var colBiases = new Array();
	
	// The row bias is the difference between the row average and the overall average
	for(var i = 1; i &lt;= rowAverages.dimensions().cols; i++)
	{
		rowBiases[i-1] = rowAverages.e(i) - average;
	}
	
	// the column bias is the difference between the column average and the overall average
	for(var i = 1; i &lt;= colAverages.dimensions().cols; i++)
	{
		colBiases[i-1] = colAverages.e(i) - average;
	}
	
	var biases = new Bias(average, $V(rowBiases), $V(colBiases));
	
	return biases;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Handling Bias
---------
In a lot of input data there is inherent bias. For example, a given user might tend to rate a great movie as 10 stars which another
 user never gives above 8 stars.
These inherent biases can skew the estimations by providing false signals to the model. To handle these, you can adjust for biases
 by including them in your model
building.
&lt;!-- language: lang-js --&gt;	
	var bias = Recommender.<span class="apidocCodeKeywordSpan">calculateBias</span>(input);
	
    // Build the model using the training set and considering the bias
    var model = Recommender.buildModelWithBias(trainingSet, bias);
	
The resulting model should be very similar to the one obtained without providing bias, but more accurate.

FAQ
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.calculateColumnAverage" id="apidoc.element.likely.calculateColumnAverage">
        function <span class="apidocSignatureSpan">likely.</span>calculateColumnAverage
        <span class="apidocSignatureSpan">(inputMatrix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function calculateColumnAverage(inputMatrix)
{
	var rows = inputMatrix.rows();
	
	var averages = new Array();
	for(var i = 1; i &lt;= inputMatrix.cols(); i++)
	{
		var sum = 0;
		for(var j = 1; j &lt;= inputMatrix.rows(); j++)
		{
			sum += inputMatrix.e(j, i);
		}
		averages[i-1] = sum/rows;
	}
	
	return $V(averages);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.calculateError" id="apidoc.element.likely.calculateError">
        function <span class="apidocSignatureSpan">likely.</span>calculateError
        <span class="apidocSignatureSpan">(estimated, input, bias)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function calculateError(estimated, input, bias)
{ 	
	var adjustedInput = input.dup();
	
	var adjustedElements = adjustedInput.elements;
		
	// If bias adjustment is provided, adjust for it
	if(bias)
	{
		// subtract the row and column bias from each row
		for(var i = 0; i &lt;= adjustedInput.rows()-1; i++)
		{
			for(var j = 0; j &lt;= adjustedInput.cols()-1; j++)
			{
				if(adjustedElements[i][j] == 0) continue; // skip zeroes
				
				adjustedElements[i][j] -= bias.average;
				
				adjustedElements[i][j] -= bias.rowBiases.e(i+1);
				
				adjustedElements[i][j] -= bias.colBiases.e(j+1);
			}
		}
	}
	
	
	var estimatedElements = estimated.elements;
	
	// Error is (R - R')
	// (but we ignore error on the zero entries since they are unknown)
	for(var i = 0; i &lt;= adjustedInput.rows()-1; i++)
	{
		for(var j = 0; j &lt;= adjustedInput.cols()-1; j++)
		{
			if(adjustedElements[i][j] == 0) continue; // skip zeroes
			
			adjustedElements[i][j] -= estimatedElements[i][j];
		}
	}				

	// Error is (R - R')
	return adjustedInput;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.calculateMatrixAverage" id="apidoc.element.likely.calculateMatrixAverage">
        function <span class="apidocSignatureSpan">likely.</span>calculateMatrixAverage
        <span class="apidocSignatureSpan">(inputMatrix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function calculateMatrixAverage(inputMatrix)
{
	var cells = inputMatrix.rows() * inputMatrix.cols();
	
	var sum = 0;
	for(var i = 1; i &lt;= inputMatrix.rows(); i++)
	{
		for(var j = 1; j &lt;= inputMatrix.cols(); j++)
		{
			sum += inputMatrix.e(i, j);
		}
	}
	
	return sum/cells;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.calculateRowAverage" id="apidoc.element.likely.calculateRowAverage">
        function <span class="apidocSignatureSpan">likely.</span>calculateRowAverage
        <span class="apidocSignatureSpan">(inputMatrix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function calculateRowAverage(inputMatrix)
{
	var cols = inputMatrix.cols();
	
	var averages = new Array();
	for(var i = 1; i &lt;= inputMatrix.rows(); i++)
	{
		var sum = 0;
		for(var j = 1; j &lt;= inputMatrix.cols(); j++)
		{
			sum += inputMatrix.e(i, j);
		}
		averages[i-1] = sum/cols;
	}
	
	return $V(averages);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.calculateTotalError" id="apidoc.element.likely.calculateTotalError">
        function <span class="apidocSignatureSpan">likely.</span>calculateTotalError
        <span class="apidocSignatureSpan">(errorMatrix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function calculateTotalError(errorMatrix)
{
	var totError = 0.0;
	for(var i = 1; i &lt;= errorMatrix.rows(); i++)
	{
		for(var j = 1; j &lt;= errorMatrix.cols(); j++)
		{
			totError += Math.pow(errorMatrix.e(i, j), 2);
		}
	}
	
	return totError;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
&lt;!-- language: lang-js --&gt;
    var Recommender = require('likely.js');

    // Build the model using the training set
    var model = Recommender.buildModel(trainingSet);
	
    // Calculate the error from the produced model against the CV set of known values
    var totalError = Recommender.<span class="apidocCodeKeywordSpan">calculateTotalError</span>(model.estimate, crossValidationSet
);


#### I trained a model using my training set but the error is too high against my CV set. What do I do?

This is common for any machine learning application. In this case it will be necessary to tune the parameters of the
Likely.js learning algorithm to better fit your data. The available options that you can adjust are as follows:
&lt;!-- language: lang-js --&gt;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.generateRandomMatrix" id="apidoc.element.likely.generateRandomMatrix">
        function <span class="apidocSignatureSpan">likely.</span>generateRandomMatrix
        <span class="apidocSignatureSpan">(rows, columns)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function generateRandomMatrix(rows, columns)
{
	return sylvester.Matrix.Random(rows, columns);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>














</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.likely.Model" id="apidoc.module.likely.Model">module likely.Model</a></h1>


    <h2>
        <a href="#apidoc.element.likely.Model.Model" id="apidoc.element.likely.Model.Model">
        function <span class="apidocSignatureSpan">likely.</span>Model
        <span class="apidocSignatureSpan">(inputMatrix, rowLabels, colLabels)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Model(inputMatrix, rowLabels, colLabels) {
	this.rowLabels = rowLabels;	// labels for the rows
	this.colLabels = colLabels; // labels for the columns
	this.input = inputMatrix;	// input data
	
	// estimated data, initialized to all zeros
	this.estimated = sylvester.Matrix.Zeros(this.input.rows(),this.input.cols());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.likely.Model.prototype" id="apidoc.module.likely.Model.prototype">module likely.Model.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.likely.Model.prototype.rankAllItems" id="apidoc.element.likely.Model.prototype.rankAllItems">
        function <span class="apidocSignatureSpan">likely.Model.prototype.</span>rankAllItems
        <span class="apidocSignatureSpan">(row)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rankAllItems = function (row)
	{
		var rowIndex = row; // assume row is a number
		// If we're using labels we have to look up the row index
		if(this.rowLabels)
		{
			rowIndex = findInArray(this.rowLabels, row);
		}
		
		// estimates for this user
		var ratingElements = this.estimated.row(rowIndex+1).elements;
		
		// build a two dimensional array from the ratings and indexes
		//     [[index, rating], [index, rating]]
		var outputArray = new Array();
		for(var i=0; i&lt;ratingElements.length; i++)
		{
			outputArray[i] = [i, ratingElements[i]];
			
			// if we have column labels, use those
			if(this.colLabels)
			{
				outputArray[i][0] = this.colLabels[i];
			}
		}
		
		// Sort the array by index
		return outputArray.sort(function(a, b) {return a[1] &lt; b[1]})
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
&lt;!-- language: lang-js --&gt;
var recommendations = model.recommendations(0);
	
// recommendations = [[3, 1.34]];

**Example 3**: Retrieve a list of all items, sorted by the ratings for a given user (both estimated and actual), using labels.
&lt;!-- language: lang-js --&gt;
var allItems = model.<span class="apidocCodeKeywordSpan">rankAllItems</span>('John');
	
// allItems = [['Green', 3.00], ['Blue', 2.00], ['Purple', 1.34], ['Red', 1.00]];

**Example 4**: Retrieve a list of all items, sorted by the ratings for a given user (both estimated and actual) without labels.
&lt;!-- language: lang-js --&gt;	
var allItems = model.rankAllItems(0);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.likely.Model.prototype.recommendations" id="apidoc.element.likely.Model.prototype.recommendations">
        function <span class="apidocSignatureSpan">likely.Model.prototype.</span>recommendations
        <span class="apidocSignatureSpan">(row)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">recommendations = function (row)
	{
		var recommendedItems = new Array();
		var allItems = this.rankAllItems(row);
			
		var rowIndex = row; // assume row is a number
		// If we're using labels we have to look up the row index
		if(this.rowLabels)
		{
			rowIndex = findInArray(this.rowLabels, row);
		}
		
		for(var i=0; i&lt; allItems.length; i++)
		{
			// look up the value in the input
			var colIndex = allItems[i][0];
			// see if we're using column labels or not
			if(this.colLabels)
			{
				colIndex = findInArray(this.colLabels, allItems[i][0]);
			}
			
			var inputRating = this.input.e(rowIndex+1, colIndex+1);
			
			// if there was no rating its a recommendation so add it
			if(inputRating == 0)
			{
				recommendedItems.push(allItems[i]);
			}
		}
		
		return recommendedItems;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
all items for all entities.

#### STEP 3. Extract recommendations
There are a few ways to retrieve recommendations from the model you have built.

**Example 1**: Retrieve a list of all items not already rated by a user, sorted by estimated ratings using labels.
&lt;!-- language: lang-js --&gt;
var recommendations = model.<span class="apidocCodeKeywordSpan">recommendations</span>('John');
	
// recommendations = [['Purple', 1.34]];


**Example 2**: Retrieve a list of all items not already rated by a user, sorted by estimated ratings without labels.
&lt;!-- language: lang-js --&gt;
var recommendations = model.recommendations(0);
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>